<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

  <title>Vaadin Grid Scroller demo</title>

  <script src="../../webcomponentsjs/webcomponents-lite.js"></script>

  <link rel="import" href="../../iron-flex-layout/iron-flex-layout.html">
  <link rel="import" href="../../iron-icons/iron-icons.html">
  <link rel="import" href="../../paper-icon-button/paper-icon-button.html">
  <link rel="import" href="../../iron-list/iron-list.html">
  <link rel="import" href="../../iron-ajax/iron-ajax.html">
  <link rel="import" href="../../app-layout/app-scroll-effects/app-scroll-effects.html">
  <link rel="import" href="../../app-layout/app-header/app-header.html">
  <link rel="import" href="../../app-layout/app-toolbar/app-toolbar.html">
  <link rel="import" href="../../app-layout/app-drawer-layout/app-drawer-layout.html">
  <link rel="import" href="../../app-layout/app-drawer/app-drawer.html">
  <link rel="import" href="../../app-layout/app-header-layout/app-header-layout.html">
  <link rel="import" href="../../app-layout/demo/sample-content.html">

  <link rel="import" href="../../paper-slider/paper-slider.html">

  <link rel="import" href="../vaadin-grid.html">
  <link rel="import" href="getjson.html">


</head>
<style>
body {
  margin: 0;
  font-family: 'Roboto', 'Noto', sans-serif;
  background-color: #eee;
}
</style>
<body unresolved>

  <x-grid></x-grid>

  <dom-module id="x-grid">
    <template>

    <style>

      app-header {
        background-color: #0b8043;
        color: white;

        --app-header-background-front-layer: {
          background-color: #4285f4;
        };
      }

      app-header paper-icon-button {
        --paper-icon-button-ink-color: white;
      }

      iron-list {
        background-color: var(--paper-grey-200, #eee);
        padding-bottom: 16px;
        @apply(--layout-flex);
      }

      .item {
        @apply(--layout-horizontal);

        margin: 16px 16px 0 16px;
        padding: 20px;

        border-radius: 8px;
        background-color: white;
        border: 1px solid #ddd;
      }

      .avatar {
        height: 40px;
        width: 40px;
        border-radius: 20px;
        box-sizing: border-box;
        background-color: #DDD;
      }

      .pad {
        padding: 0 16px;
        @apply(--layout-flex);
        @apply(--layout-vertical);
      }

      .primary {
        font-size: 16px;
        font-weight: bold;
      }

      .secondary {
        font-size: 14px;
      }

      .dim {
        color: gray;
      }

      .mainHeader [main-title] {
        font-weight: 400;
        margin: 0 0 0 50px;
      }

      .mainHeader [condensed-title] {
        font-weight: 400;
        margin-left: 30px;
      }

      .mainHeader [condensed-title] i {
        font-style: normal;
        font-weight: 100;
      }

      app-toolbar.tall {
        height: 148px;
      }

      vaadin-grid {
        height: 500px;
      }

      section {
        margin: 10px;
        padding: 10px;
        border: 1px solid #ccc;
      }

      section app-toolbar {
        padding: 0 !important;
      }

      vaadin-grid /deep/ vaadin-grid-table /deep/ table {
        background: #fff;
      }

      img {
        position: absolute;
        top: 5px;

        height: 30px;
      }




    </style>

      <app-drawer-layout>
        <app-drawer swipe-open>

          <section>
            <app-toolbar>Size</app-toolbar>
            <paper-input value="{{size}}"></paper-input>
          </section>

          <section>
            <app-toolbar>Frozen columns</app-toolbar>
            <paper-slider pin value="1" min="0" max="3" immediate-value="{{frozenColumns}}"></paper-slider>
          </section>

          <section>
            <app-toolbar>1st Column Width</app-toolbar>
            <paper-slider min="100" max="300" immediate-value="{{width}}"></paper-slider>
          </section>

          <section>
            <app-toolbar>Every 3rd Row Height</app-toolbar>
            <paper-slider min="22" max="200" immediate-value="{{height}}" on-immediate-value-changed="_heightChanged"></paper-slider>
          </section>

          <section>
            <app-toolbar>Colspan</app-toolbar>
            <paper-slider min="0" max="3" on-immediate-value-changed="_colspanChanged"></paper-slider>
          </section>

        </app-drawer>
        <app-header-layout>
          <app-header class="mainHeader" condenses fixed effects="resize-title blend-background waterfall">
            <app-toolbar>
              <paper-icon-button icon="menu" drawer-toggle></paper-icon-button>
              <h4 condensed-title>Vaadin Grid Scroller</h4>
            </app-toolbar>
            <app-toolbar class="tall">
              <h1 main-title>Vaadin Grid Scroller</h1>
            </app-toolbar>
          </app-header>

          <vaadin-grid id="component" size="[[size]]" row-count="2">
            <vaadin-grid-column width="[[width]]px">
              <template>
                <div class="elItem" style$="[[_getStyle(index, height)]]">#[[index]]</div>
              </template>
              <template is="header">
                <b class="elItem">Index</b>
              </template>
              <template is="header">

              </template>
            </vaadin-grid-column>

            <vaadin-grid-column  width="150px">
              <template>
                <img src="[[_getUserProperty(index, 'picture.thumbnail')]]"></img>
              </template>
              <template is="header">
                Picture
              </template>
              <template is="header">
              </template>
            </vaadin-grid-column>

            <vaadin-grid-column>
              <template>
                [[_getUserProperty(index, 'name.first')]]
              </template>
              <template is="header">
                Name
              </template>
              <template is="header">
                First
              </template>
            </vaadin-grid-column>

            <vaadin-grid-column width="200px">
              <template>
                [[_getUserProperty(index, 'name.last')]]
              </template>
              <template is="header">

              </template>
              <template is="header" colspan="2">
                Last
              </template>
            </vaadin-grid-column>

            <vaadin-grid-column min-width="300px">
              <template>
                [[_getUserProperty(index, 'email')]]
              </template>
              <template is="header">
                Email
              </template>
              <template is="header">
              </template>
            </vaadin-grid-column>

          </vaadin-grid>

          <iron-ajax url="../../app-layout/demo/contacts.json" last-response="{{data}}" auto></iron-ajax>

        </app-header-layout>
      </app-drawer-layout>

    </template>

    <script>
      Polymer({
        is: 'x-grid',

        properties: {
          size: {
            value: 1000
          },

          width: {
            value: 100
          }
        },

        observers: [
          '_onFrozenChanged(frozenColumns)'
        ],

        _onFrozenChanged: function(f) {
          this.$.component.columns[this.$.component.columns.length - 1]
          .forEach(function(c, i) {
            c.toggleAttribute('frozen', i < f);
          })
        },

        iconForItem: function(item) {
          return item ? (item.integer < 50 ? 'star-border' : 'star') : '';
        },

        _getUserProperty: function(index, prop) {
          var user = window.getJSON('http://randomuser.me?index='+index);

          return this.get('user.' + prop, user);
        },

        _getStyle: function(index, height) {
          if (index % 3 === 0) {
            return 'height: ' + height + 'px';
          } else {
            return '';
          }

        },

        _heightChanged: function(e) {
          this.$.component.$.scroller.notifyResize();
        },

        _colspanChanged: function(e) {
          var th = this.$.component.$.scroller.$.header.querySelectorAll('th:not([frozen])')[0];
          if (th) {
            th.colspan = e.detail.value;
          }
        }



      });
    </script>
  </dom-module>



</body>
</html>
