<dom-module id="grid-data-demos">
  <template>
    <style include="vaadin-component-demo-shared-styles">
      :host {
        display: block;
      }
    </style>

    <h3>Assigning Array Data</h3>
    <p>An array of objects can be assigned to the <code>items</code> property.</p>
    <vaadin-demo-snippet id='grid-data-demos-assigning-array-data'>
      <template preserve-content>
        <vaadin-grid aria-label="Array Data Example">
          <vaadin-grid-column width="60px" flex-grow="0"></vaadin-grid-column>
          <vaadin-grid-column></vaadin-grid-column>
          <vaadin-grid-column></vaadin-grid-column>
        </vaadin-grid>
        <script>
          window.addDemoReadyListener('#grid-data-demos-assigning-array-data', function(document) {
            const grid = document.querySelector('vaadin-grid');
            const columns = document.querySelectorAll('vaadin-grid-column');

            columns[0].renderer = function(root, column, model) {
              root.textContent = model.index;
            };

            columns[1].renderer = function(root, column, model) {
              root.textContent = model.item.firstName;
            };

            columns[2].renderer = function(root, column, model) {
              root.textContent = model.item.lastName;
            };

            columns[0].headerRenderer = function(root) {
              root.textContent = '#';
            };

            columns[1].headerRenderer = function(root) {
              root.textContent = 'First Name';
            };

            columns[2].headerRenderer = function(root) {
              root.textContent = 'Last Name';
            };

            const items = [];
            for (var i = 0; i < 100; i++) {
              items.push({firstName: 'First Name ' + i, lastName: 'Last Name ' + i});
            }

            grid.items = items;
          });
        </script>
      </template>
    </vaadin-demo-snippet>


    <h3>Dynamic Array Data</h3>
    <p>
      The <code>items</code> property can be modified using array manipulations.
    </p>
    <vaadin-demo-snippet id='grid-data-demos-dynamic-array-data'>
      <template preserve-content>
        <style>
          vaadin-button {
            margin-bottom: 20px;
          }
        </style>
        <vaadin-button raised id="add-btn">Add Item</vaadin-button>
        <vaadin-button raised id="remove-btn">Remove Item</vaadin-button>

        <vaadin-grid aria-label="Dynamic Data Example">
          <vaadin-grid-column width="60px" flex-grow="0"></vaadin-grid-column>
          <vaadin-grid-column></vaadin-grid-column>
          <vaadin-grid-column></vaadin-grid-column>
        </vaadin-grid>
        <script>
          window.addDemoReadyListener('#grid-data-demos-dynamic-array-data', function(document) {
            const grid = document.querySelector('vaadin-grid');
            const addBtn = document.querySelector('#add-btn');
            const removeBtn = document.querySelector('#remove-btn');

            addBtn.addEventListener('click', function() {
              const newItemsArray = grid.items.slice(0);
              newItemsArray.push({firstName: 'First Name ' + newItemsArray.length, lastName: 'Last Name ' + newItemsArray.length});
              grid.items = newItemsArray;
            });

            removeBtn.addEventListener('click', function() {
              const newItemsArray = grid.items.slice(0);
              newItemsArray.pop();
              grid.items = newItemsArray;
            });

            const columns = document.querySelectorAll('vaadin-grid-column');

            columns[0].renderer = function(root, column, model) {
              root.textContent = model.index;
            };

            columns[1].renderer = function(root, column, model) {
              root.textContent = model.item.firstName;
            };

            columns[2].renderer = function(root, column, model) {
              root.textContent = model.item.lastName;
            };

            columns[0].headerRenderer = function(root) {
              root.textContent = '#';
            };

            columns[1].headerRenderer = function(root) {
              root.textContent = 'First Name';
            };

            columns[2].headerRenderer = function(root) {
              root.textContent = 'Last Name';
            };

            const items = [];
            for (var i = 0; i < 100; i++) {
              items.push({firstName: 'First Name ' + i, lastName: 'Last Name ' + i});
            }

            grid.items = items;
          });
        </script>
      </template>
    </vaadin-demo-snippet>


    <h3>Dynamic Height</h3>
    <p>
      Setting <code>height-by-rows</code> will make <code>&lt;vaadin-grid&gt;</code> grow
      and shrink in height depending on the number of rows.
    </p>
    <vaadin-demo-snippet id='grid-data-demos-dynamic-height'>
      <template preserve-content>
        <style>
          vaadin-button {
            margin-bottom: 20px;
          }
        </style>
        <vaadin-button raised id="add-btn">Add Item</vaadin-button>
        <vaadin-button raised id="remove-btn">Remove Item</vaadin-button>

        <vaadin-grid aria-label="Dynamic Data Example" height-by-rows>
          <vaadin-grid-column width="60px" flex-grow="0"></vaadin-grid-column>
          <vaadin-grid-column></vaadin-grid-column>
          <vaadin-grid-column></vaadin-grid-column>
        </vaadin-grid>
        <script>
          window.addDemoReadyListener('#grid-data-demos-dynamic-height', function(document) {
            const grid = document.querySelector('vaadin-grid');
            const addBtn = document.querySelector('#add-btn');
            const removeBtn = document.querySelector('#remove-btn');

            addBtn.addEventListener('click', function() {
              const newItemsArray = grid.items.slice(0);
              newItemsArray.push({firstName: 'First Name ' + newItemsArray.length, lastName: 'Last Name ' + newItemsArray.length});
              grid.items = newItemsArray;
            });

            removeBtn.addEventListener('click', function() {
              const newItemsArray = grid.items.slice(0);
              newItemsArray.pop();
              grid.items = newItemsArray;
            });

            const columns = document.querySelectorAll('vaadin-grid-column');

            columns[0].renderer = function(root, column, model) {
              root.textContent = model.index;
            };

            columns[1].renderer = function(root, column, model) {
              root.textContent = model.item.firstName;
            };

            columns[2].renderer = function(root, column, model) {
              root.textContent = model.item.lastName;
            };

            columns[0].headerRenderer = function(root) {
              root.textContent = '#';
            };

            columns[1].headerRenderer = function(root) {
              root.textContent = 'First Name';
            };

            columns[2].headerRenderer = function(root) {
              root.textContent = 'Last Name';
            };

            const items = [];
            for (var i = 0; i < 5; i++) {
              items.push({firstName: 'First Name ' + i, lastName: 'Last Name ' + i});
            }

            grid.items = items;
          });
        </script>
      </template>
    </vaadin-demo-snippet>


    <h3>Assigning Remote/Function Data</h3>
    <p>
      A function can be assigned to the <code>dataProvider</code> property to provide
      data from a remote source.
    </p>
    <p>
      <b>Note:</b> the total number of items must be set to the grid. The example
      below sets the total number of items using the <code>size</code> property.
    </p>
    <p>
      Alternatively, the total size can be provided in the second argument of the
      data provider <code>callback</code>, see tree demo example.
    </p>
    <vaadin-demo-snippet id='grid-data-demos-assigning-remotefunction-data'>
      <template preserve-content>
        <vaadin-grid aria-label="Remote Data Example">
          <vaadin-grid-column width="60px" flex-grow="0"></vaadin-grid-column>
          <vaadin-grid-column></vaadin-grid-column>
          <vaadin-grid-column></vaadin-grid-column>
        </vaadin-grid>
        <script>
          window.addDemoReadyListener('#grid-data-demos-assigning-remotefunction-data', function(document) {
            const grid = document.querySelector('vaadin-grid');

            grid.size = 200;
            grid.dataProvider = function(params, callback) {
              var xhr = new XMLHttpRequest();
              xhr.onload = function() {
                callback(JSON.parse(xhr.responseText).result);
              };
              var index = params.page * params.pageSize;
              xhr.open('GET', 'https://demo.vaadin.com/demo-data/1.0/people?index=' + index + '&count=' + params.pageSize, true);
              xhr.send();
            };

            const columns = document.querySelectorAll('vaadin-grid-column');

            columns[0].renderer = function(root, column, model) {
              root.textContent = model.index;
            };

            columns[1].renderer = function(root, column, model) {
              root.textContent = model.item.firstName;
            };

            columns[2].renderer = function(root, column, model) {
              root.textContent = model.item.lastName;
            };

            columns[0].headerRenderer = function(root) {
              root.textContent = '#';
            };

            columns[1].headerRenderer = function(root) {
              root.textContent = 'First Name';
            };

            columns[2].headerRenderer = function(root) {
              root.textContent = 'Last Name';
            };
          });
        </script>
      </template>
    </vaadin-demo-snippet>


  </template>
  <script>
    class GridDataDemos extends DemoReadyEventEmitter(GridDemo(Polymer.Element)) {
      static get is() {
        return 'grid-data-demos';
      }
    }
    customElements.define(GridDataDemos.is, GridDataDemos);
  </script>
</dom-module>
